<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Hydrate Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Friendly font -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --main: #36c0e0;
            --main-dark: #2776a8;
            --accent: #ffb347;
            --bg: #f9fbff;
            --card: #fff;
            --bar-fill: #36c0e0;
            --bar-bg: #eaf6fc;
            --bottle-bg: #eaf6fc;
            --bottle-fill: #36c0e0;
            --bottle-fill-low: #ffd7d7;
            --danger: #ff5f5f;
            --success: #29c6a0;
            --gray: #bbb;
        }
        body {
            font-family: 'Quicksand', Arial, sans-serif;
            background: var(--bg);
            margin: 0;
        }
        .container {
            max-width: 390px;
            margin: 32px auto;
            background: var(--card);
            border-radius: 20px;
            box-shadow: 0 6px 32px rgba(52, 152, 219, 0.08);
            padding: 24px 20px 20px 20px;
        }
        h2 {
            font-weight: 700;
            font-size: 1.45rem;
            margin-bottom: 3px;
            color: var(--main-dark);
            letter-spacing: 0.5px;
        }
        .date {
            color: var(--main);
            font-size: 1.03rem;
            margin-bottom: 6px;
        }
        .goal-card {
            background: var(--card);
            border-radius: 13px;
            margin: 18px 0 18px 0;
            padding: 17px 13px 12px 13px;
            box-shadow: 0 2px 14px rgba(52,152,219,0.06);
        }
        .goal-row {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            font-size: 1.07rem;
        }
        .goal-bar-bg {
            background: var(--bar-bg);
            height: 12px;
            border-radius: 6px;
            margin: 14px 0 7px 0;
            width: 100%;
            overflow: hidden;
        }
        .goal-bar {
            height: 12px;
            border-radius: 6px;
            background: linear-gradient(90deg, var(--main) 0%, var(--success) 100%);
            width: 0;
            transition: width 0.8s cubic-bezier(.57,.21,.69,1.25);
        }
        .goal-stats {
            display: flex;
            justify-content: space-between;
            font-size: 1rem;
            color: var(--main-dark);
            margin-top: 1px;
        }
        /* Add water section */
        .add-water-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0 19px 0;
        }
        .add-water-circle {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle at 60% 20%, var(--main) 56%, var(--success) 100%);
            border-radius: 50%;
            box-shadow: 0 4px 16px rgba(52,152,219,0.09);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 700;
            font-size: 1.08rem;
            cursor: pointer;
            margin-bottom: 15px;
            user-select: none;
            transition: transform 0.15s;
            position: relative;
        }
        .add-water-circle:active {
            transform: scale(0.97);
        }
        .add-water-circle .icon {
            font-size: 2.1rem;
            margin-bottom: 5px;
            animation: dropAnim 1.2s infinite cubic-bezier(.57,.21,.69,1.25);
        }
        @keyframes dropAnim {
            0% { transform: translateY(0);}
            60% { transform: translateY(-8px);}
            100% { transform: translateY(0);}
        }
        .water-btns {
            display: flex;
            gap: 13px;
            margin-bottom: 12px;
            margin-top: 7px;
        }
        .water-btn {
            background: var(--card);
            color: var(--main);
            border: 1.5px solid var(--main);
            border-radius: 8px;
            padding: 6px 18px;
            font-size: 1.07rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.22s, color 0.22s;
        }
        .water-btn.active, .water-btn:hover {
            background: var(--main);
            color: #fff;
        }
        .custom-amount-btn {
            background: var(--bar-bg);
            color: var(--main-dark);
            border: none;
            border-radius: 8px;
            padding: 7px 0;
            width: 100%;
            font-size: 1.06rem;
            cursor: pointer;
            margin-bottom: 10px;
            margin-top: 0;
            transition: background 0.18s;
            font-weight: 600;
        }
        .custom-amount-btn:hover {
            background: #d6eaf8;
        }
        /* Week bar with bottles */
        .week-card {
            background: var(--card);
            border-radius: 13px;
            margin-top: 13px;
            padding: 15px 9px 18px 9px;
            box-shadow: 0 2px 14px rgba(52,152,219,0.05);
        }
        .week-title {
            font-weight: 700;
            font-size: 1.09rem;
            margin-bottom: 13px;
        }
        .week-days {
            display: flex;
            gap: 10px;
            justify-content: space-between;
        }
        .week-day {
            flex: 1;
            min-width: 32px;
            min-height: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            color: var(--main-dark);
            font-size: 0.98rem;
            font-weight: 700;
            position: relative;
        }
        .bottle-svg {
            width: 32px;
            height: 65px;
            display: block;
            margin-bottom: 7px;
        }
        .bottle-fill {
            transition: height 0.7s cubic-bezier(.57,.21,.69,1.25);
        }
        .week-day.today {
            color: var(--accent);
            font-weight: 700;
        }
        /* Adaugari lista */
        .history-card {
            background: var(--card);
            border-radius: 13px;
            margin-top: 16px;
            padding: 14px 10px 14px 10px;
            box-shadow: 0 2px 14px rgba(52,152,219,0.04);
        }
        .history-title {
            font-weight: 700;
            font-size: 1.05rem;
            margin-bottom: 7px;
        }
        .history-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .history-list li {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.99rem;
            margin-bottom: 6px;
            background: var(--bar-bg);
            border-radius: 8px;
            padding: 7px 12px;
            animation: fadeIn 0.5s;
        }
        .delete-btn {
            background: var(--danger);
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 0.97rem;
            padding: 4px 10px;
            cursor: pointer;
            transition: background 0.15s;
        }
        .delete-btn:hover {
            background: #c0392b;
        }
        /* Notificari */
        .notif-section {
            margin-top: 22px;
            background: var(--bar-bg);
            border-radius: 11px;
            padding: 13px 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .notif-title {
            font-weight: 700;
            font-size: 1.07rem;
            margin-bottom: 7px;
            color: var(--main-dark);
        }
        .notif-row {
            display: flex;
            align-items: center;
            gap: 14px;
        }
        .notif-row label {
            font-weight: 600;
            font-size: 1.01rem;
        }
        .notif-row input[type="number"] {
            border-radius: 7px;
            border: 1px solid var(--gray);
            padding: 6px 10px;
            font-size: 1.01rem;
            width: 60px;
            text-align: center;
            margin-left: 7px;
        }
        .notif-toggle {
            appearance: none;
            width: 42px;
            height: 22px;
            background: #eee;
            border-radius: 11px;
            position: relative;
            outline: none;
            cursor: pointer;
            transition: background 0.22s;
        }
        .notif-toggle:checked {
            background: var(--main);
        }
        .notif-toggle::before {
            content: '';
            position: absolute;
            left: 4px;
            top: 4px;
            width: 14px;
            height: 14px;
            background: #fff;
            border-radius: 50%;
            transition: left 0.2s;
        }
        .notif-toggle:checked::before {
            left: 24px;
        }
        .notif-status {
            font-size: 0.97rem;
            color: var(--main-dark);
            margin-top: 8px;
            min-height: 23px;
        }
        /* Custom amount modal */
        .custom-amount-modal {
            position: fixed;
            left: 0; top: 0; right: 0; bottom: 0;
            background: rgba(52, 152, 219, 0.16);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }
        .custom-amount-content {
            background: var(--card);
            border-radius: 14px;
            padding: 26px 22px 18px 22px;
            box-shadow: 0 4px 20px rgba(52,152,219,0.13);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .custom-amount-content input {
            font-size: 1.09rem;
            border-radius: 8px;
            border: 1px solid var(--gray);
            padding: 7px 13px;
            width: 110px;
            margin-bottom: 15px;
            text-align: center;
        }
        .custom-amount-content button {
            background: var(--main);
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 7px 24px;
            font-size: 1.07rem;
            font-weight: 600;
            cursor: pointer;
        }
        .custom-amount-content button:hover {
            background: var(--main-dark);
        }
        /* Animatie fadeIn */
        .fade-in {
            animation: fadeIn 0.39s cubic-bezier(.57,.21,.69,1.25);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px);}
            to { opacity: 1; transform: translateY(0);}
        }
    </style>
</head>
<body>
    <div class="container fade-in">
        <h2>Hydrate</h2>
        <div class="date" id="today-date"></div>
        <div class="goal-card">
            <div class="goal-row">
                <span>Obiectiv zilnic</span>
            </div>
            <div style="font-size: 1.18rem; font-weight: 700;" id="daily-goal"></div>
            <div class="goal-bar-bg">
                <div class="goal-bar" id="goal-bar"></div>
            </div>
            <div class="goal-stats">
                <span id="consumed-label"></span>
                <span id="remaining-label"></span>
            </div>
        </div>
        <div class="add-water-section">
            <div class="add-water-circle" id="add-water-main" title="Adaugă apă">
                <span class="icon">💧</span>
                <div>Adaugă apă</div>
                <div style="font-size:0.98rem; font-weight:500;" id="selected-amount">250ml</div>
            </div>
            <div class="water-btns">
                <button class="water-btn" data-amount="100">100ml</button>
                <button class="water-btn active" data-amount="250">250ml</button>
                <button class="water-btn" data-amount="500">500ml</button>
            </div>
            <button class="custom-amount-btn" id="customAmountBtn">Cantitate personalizată</button>
        </div>
        <div class="week-card">
            <div class="week-title">Săptămâna aceasta</div>
            <div class="week-days" id="week-days"></div>
        </div>
        <div class="history-card">
            <div class="history-title">Adăugări azi</div>
            <ul class="history-list" id="history-list"></ul>
        </div>
        <div class="notif-section">
            <div class="notif-title">Notificări</div>
            <div class="notif-row">
                <label>
                    <input type="checkbox" id="notifToggle" class="notif-toggle">
                    Activează notificări
                </label>
                <label>
                    La fiecare
                    <input type="number" id="notifIntervalInput" min="1" max="8" step="1"> ore
                </label>
            </div>
            <div class="notif-status" id="notif-status"></div>
        </div>
    </div>
    <!-- Custom Amount Modal -->
    <div class="custom-amount-modal" id="customAmountModal" style="display:none;">
        <div class="custom-amount-content">
            <label for="customAmountInput">Introdu cantitate (ml):</label>
            <input type="number" id="customAmountInput" min="50" max="2000" value="200">
            <button id="customAmountOk">OK</button>
        </div>
    </div>
    <script>
        // Utils
        function getToday() {
            const today = new Date();
            return today.toISOString().split('T')[0];
        }
        function getWaterData() {
            return JSON.parse(localStorage.getItem("waterData_v2") || "{}");
        }
        function saveWaterData(data) {
            localStorage.setItem("waterData_v2", JSON.stringify(data));
        }
        function getGoal() {
            return parseFloat(localStorage.getItem("dailyGoal") || "2.5");
        }
        function saveGoal(val) {
            localStorage.setItem("dailyGoal", val);
        }
        function getInterval() {
            return parseInt(localStorage.getItem("waterInterval") || "2");
        }
        function saveInterval(val) {
            localStorage.setItem("waterInterval", val);
        }
        function getNotifActive() {
            return localStorage.getItem("notifActive") === "true";
        }
        function saveNotifActive(val) {
            localStorage.setItem("notifActive", val ? "true" : "false");
        }
        // UI Fill
        function fillDate() {
            const d = new Date();
            document.getElementById("today-date").textContent = d.toLocaleDateString('ro-RO', {
                weekday:'long', day:'numeric', month:'long'
            });
        }
        function fillGoalCard() {
            const goal = getGoal();
            const data = getWaterData();
            const todayKey = getToday();
            // Suma adăugărilor din zi
            const consumed = ((data[todayKey]?.reduce((a,b)=>a+b,0)) || 0) / 1000;
            document.getElementById("daily-goal").textContent = goal + "L";
            document.getElementById("consumed-label").textContent = consumed.toFixed(1) + "L băut";
            let remaining = Math.max(goal - consumed, 0);
            document.getElementById("remaining-label").textContent = remaining.toFixed(1) + "L rămas";
            // Progres bar
            let percent = Math.min(consumed/goal, 1);
            document.getElementById("goal-bar").style.width = (percent*100) + "%";
        }
        function fillWeek() {
            const daysRO = ["Luni","Marți","Miercuri","Joi","Vineri","Sâmbătă","Duminică"];
            const week = [];
            const today = new Date();
            let todayIdx = today.getDay()===0?6:today.getDay()-1; // 0=duminica
            const data = getWaterData();
            for(let i=0;i<7;i++) {
                const d = new Date(today);
                d.setDate(today.getDate()-todayIdx+i);
                const key = d.toISOString().split('T')[0];
                let amt = ((data[key]?.reduce((a,b)=>a+b,0)) || 0);
                let goal = getGoal()*1000;
                week.push({day: d, amt, goal, idx:i});
            }
            let out = '';
            week.forEach((w,idx) => {
                let percent = Math.min(w.amt/w.goal, 1);
                let fillHeight = Math.max(percent*45, 7);
                let isToday = w.day.toDateString() === today.toDateString();
                let fillColor = percent < 0.5 ? "var(--bottle-fill-low)" : "url(#blueGradient)";
                out += `
                <div class="week-day${isToday?' today':''}">
                    <svg class="bottle-svg" viewBox="0 0 32 65">
                        <rect x="7" y="10" width="18" height="50" rx="7" fill="var(--bottle-bg)"/>
                        <rect class="bottle-fill" x="7" y="${60-fillHeight}" width="18" height="${fillHeight}" rx="7" fill="${fillColor}"/>
                        <defs>
                            <linearGradient id="blueGradient" x1="0" y1="0" x2="0" y2="1">
                                <stop offset="0%" stop-color="#29c6a0"/>
                                <stop offset="100%" stop-color="#36c0e0"/>
                            </linearGradient>
                        </defs>
                        <rect x="11" y="4" width="10" height="9" rx="4" fill="var(--bottle-bg)"/>
                    </svg>
                    <span>${daysRO[idx]}</span>
                </div>`;
            });
            document.getElementById("week-days").innerHTML = out;
        }
        // Selected amount
        let selectedAmount = 250;
        function updateSelectedAmountUI() {
            document.getElementById("selected-amount").textContent = selectedAmount + "ml";
            document.querySelectorAll(".water-btn").forEach(btn => {
                btn.classList.toggle("active", btn.dataset.amount == selectedAmount);
            });
        }
        // Adaugă apă
        function addWater(amount) {
            if(isNaN(amount) || amount < 50) return;
            const data = getWaterData();
            const key = getToday();
            if(!data[key]) data[key] = [];
            data[key].push(amount);
            saveWaterData(data);
            fillGoalCard();
            fillWeek();
            fillHistory();
        }
        // Water buttons
        document.querySelectorAll(".water-btn").forEach(btn => {
            btn.onclick = () => {
                selectedAmount = parseInt(btn.dataset.amount);
                updateSelectedAmountUI();
            };
        });
        // Main add water circle
        document.getElementById("add-water-main").onclick = () => {
            addWater(selectedAmount);
        };
        // Custom amount modal
        document.getElementById("customAmountBtn").onclick = () => {
            document.getElementById("customAmountModal").style.display = "flex";
            document.getElementById("customAmountInput").value = selectedAmount;
        };
        document.getElementById("customAmountOk").onclick = () => {
            let val = parseInt(document.getElementById("customAmountInput").value);
            if(isNaN(val) || val < 50 || val > 2000) {
                alert("Introdu o valoare între 50 și 2000ml.");
                return;
            }
            selectedAmount = val;
            updateSelectedAmountUI();
            document.getElementById("customAmountModal").style.display = "none";
        };
        document.getElementById("customAmountModal").onclick = (e) => {
            if(e.target === document.getElementById("customAmountModal")) {
                document.getElementById("customAmountModal").style.display = "none";
            }
        };
        // History
        function fillHistory() {
            const key = getToday();
            const data = getWaterData();
            const list = document.getElementById("history-list");
            list.innerHTML = '';
            (data[key]||[]).forEach((amt,idx) => {
                let li = document.createElement('li');
                li.innerHTML = `<span>${amt} ml</span> <button class="delete-btn" title="Șterge" data-idx="${idx}">✕</button>`;
                list.appendChild(li);
            });
            // Delete
            document.querySelectorAll(".delete-btn").forEach(btn => {
                btn.onclick = () => {
                    data[key].splice(parseInt(btn.dataset.idx),1);
                    saveWaterData(data);
                    fillGoalCard();
                    fillWeek();
                    fillHistory();
                };
            });
        }
        // Notificari
        let notificationTimer = null;
        function setupNotifications() {
            if(notificationTimer) clearInterval(notificationTimer);
            const notifActive = getNotifActive();
            const statusEl = document.getElementById("notif-status");
            if(!notifActive) {
                statusEl.textContent = "Notificările sunt dezactivate.";
                return;
            }
            if(Notification.permission === "default") {
                Notification.requestPermission().then(perm => {
                    if(perm==='granted') setupNotifications();
                });
                statusEl.textContent = "Permite notificările din browser!";
                return;
            }
            if(Notification.permission === "granted") {
                let interval = getInterval();
                statusEl.textContent = `Vei primi notificare la fiecare ${interval} ore.`;
                notificationTimer = setInterval(() => {
                    new Notification("E timpul să bei apă! 💧");
                }, interval*60*60*1000);
            } else {
                statusEl.textContent = "Permite notificările din browser!";
            }
        }
        // Notif UI
        function fillNotifUI() {
            document.getElementById("notifToggle").checked = getNotifActive();
            document.getElementById("notifIntervalInput").value = getInterval();
        }
        document.getElementById("notifToggle").onchange = function() {
            saveNotifActive(this.checked);
            setupNotifications();
        };
        document.getElementById("notifIntervalInput").onchange = function() {
            let val = parseInt(this.value);
            if(isNaN(val) || val < 1 || val > 8) {
                this.value = getInterval();
                return;
            }
            saveInterval(val);
            setupNotifications();
        };
        // On load
        window.onload = function() {
            fillDate();
            fillGoalCard();
            fillWeek();
            updateSelectedAmountUI();
            fillHistory();
            fillNotifUI();
            setupNotifications();
        };
    </script>
</body>
</html>